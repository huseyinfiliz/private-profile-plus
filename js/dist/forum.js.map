{"version":3,"file":"forum.js","mappings":"MACA,IAAIA,EAAsB,CCA1BA,EAAyBC,IACxB,IAAIC,EAASD,GAAUA,EAAOE,WAC7B,IAAOF,EAAiB,QACxB,IAAM,EAEP,OADAD,EAAoBI,EAAEF,EAAQ,CAAEG,EAAGH,IAC5BA,GCLRF,EAAwB,CAACM,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXP,EAAoBS,EAAEF,EAAYC,KAASR,EAAoBS,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,MCJ3ER,EAAwB,CAACc,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,I,mBCAlF,MAAM,EAA+BI,OAAOC,KAAKC,OAAO,a,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,iBCAlD,EAA+BF,OAAOC,KAAKC,OAAO,iC,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,4B,aCAxD,MAAM,EAA+BF,OAAOC,KAAKC,OAAO,6B,aCIxDC,IAAAA,aAAiBC,IAAI,uBAAwB,YCY3CC,EAAAA,EAAAA,QAAOC,IAAAA,UAAwB,gBAAiB,SAA8BC,GAAO,IAAAC,EAX9DC,EACjBpB,EAU+EqB,EAAA,KAE7EC,GAZFtB,EAA8B,CAClCuB,SAAU,wEACVC,QAAS,uEACTC,QAAS,yEAJYL,EAYCM,OAAOZ,IAAAA,MAAUa,UAAU,6BAA+B,aAL7Db,IAAAA,WAAec,MAAM5B,EAAIoB,IAAqBA,EAQjE,GAAKS,KAAKC,KAAV,CAEA,IAAMC,EAAeL,QAA8B,OAAvBP,EAAAU,KAAKC,KAAKE,oBAAa,EAAvBb,EAAyBc,oBAAqB,WAMpEC,EAAkC,CACtCC,QALyBrB,IAAAA,WAAec,MAAM,uEAAwE,CACtHR,MAAOE,IAKPC,SAAUT,IAAAA,WAAec,MAAM,yEAC/BJ,QAASV,IAAAA,WAAec,MAAM,wEAC9BH,QAASX,IAAAA,WAAec,MAAM,yEAGhCV,EAAMH,IACJ,oBACAqB,EAAE,cAAe,CACfA,EAAE,QAAStB,IAAAA,WAAec,MAAM,qFAChCQ,EAAE,YAAatB,IAAAA,WAAec,MAAM,kFACpCQ,EAAEC,IAAQ,CACRH,QAASA,EACTI,MAAOP,EACPQ,SAAU,SAACD,GACTjB,EAAKS,KAAMU,gBAAgB,CAAEP,kBAAmBK,GAClD,MAzBgB,CA6BxB,IC5CAtB,EAAAA,EAAAA,QAAOyB,IAAAA,UAAoB,WAAY,WACrC,IAAMX,EAAOD,KAAKC,KAElB,GAAKA,EAAL,CAEA,IAAMY,EAAsBZ,EAAKH,UAAU,8BACrCgB,EAAc7B,IAAAA,QAAYgB,KAC1Bc,EAAUD,GAAeA,EAAYE,OAASf,EAAKe,KACnDC,EAAYhC,IAAAA,MAAUa,UAAU,8BAElCoB,GAAU,EAEd,OAAQL,GACN,IAAK,WASL,QACEK,GAAU,QAPZ,IAAK,UACHA,IAAYJ,EACZ,MACF,IAAK,UACHI,KAAaH,IAAWE,GAM5B,IAAIC,EAAJ,CAGA,IAGMC,EAHAC,EAAqBpB,KAAKqB,QAAQC,cAAc,kEAEhC,MAAlBF,GAAAA,EAAoBE,cAAc,OAIlCH,EAD0B,YAAxBN,EACW,+DAEA,0DAGfO,EAAmBE,cAAc,KAAMC,YAActC,IAAAA,WAAec,MAAMoB,GAdzD,CAvBF,CAuCnB,EFxCF,E","sources":["webpack://@huseyinfiliz/private-profile-plus/webpack/bootstrap","webpack://@huseyinfiliz/private-profile-plus/webpack/runtime/compat get default export","webpack://@huseyinfiliz/private-profile-plus/webpack/runtime/define property getters","webpack://@huseyinfiliz/private-profile-plus/webpack/runtime/hasOwnProperty shorthand","webpack://@huseyinfiliz/private-profile-plus/external root \"flarum.core.compat['forum/app']\"","webpack://@huseyinfiliz/private-profile-plus/external root \"flarum.core.compat['common/extend']\"","webpack://@huseyinfiliz/private-profile-plus/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@huseyinfiliz/private-profile-plus/external root \"flarum.core.compat['common/components/Select']\"","webpack://@huseyinfiliz/private-profile-plus/external root \"flarum.core.compat['forum/components/UserPage']\"","webpack://@huseyinfiliz/private-profile-plus/./src/forum/index.js","webpack://@huseyinfiliz/private-profile-plus/./src/forum/addProfileVisibilitySettings.tsx","webpack://@huseyinfiliz/private-profile-plus/./src/forum/addProfileVisibilityHandler.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/UserPage'];","import app from 'flarum/forum/app';\nimport addProfileVisibilitySettings from './addProfileVisibilitySettings';\nimport addProfileVisibilityHandler from './addProfileVisibilityHandler';\n\napp.initializers.add('private-profile-plus', () => {\n  addProfileVisibilitySettings();\n  addProfileVisibilityHandler();\n});\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport SettingsPage from 'flarum/forum/components/SettingsPage';\nimport Select from 'flarum/common/components/Select';\n\nfunction visibilityLabel(level: string): string {\n  const key: Record<string, string> = {\n    everyone: 'huseyinfiliz-private-profile-plus.forum.user.settings.option_everyone',\n    members: 'huseyinfiliz-private-profile-plus.forum.user.settings.option_members',\n    private: 'huseyinfiliz-private-profile-plus.forum.user.settings.option_private',\n  };\n\n  return key[level] ? (app.translator.trans(key[level]) as string) : level;\n}\n\nexport default function addProfileVisibilitySettings() {\n  extend(SettingsPage.prototype, 'settingsItems', function (this: SettingsPage, items) {\n    const globalDefault = String(app.forum.attribute('profileVisibilityDefault') || 'everyone');\n    const globalDefaultLabel = visibilityLabel(globalDefault);\n\n    if (!this.user) return;\n\n    const currentValue = String(this.user.preferences()?.profileVisibility || 'default');\n\n    const defaultOptionLabel = app.translator.trans('huseyinfiliz-private-profile-plus.forum.user.settings.option_default', {\n      level: globalDefaultLabel,\n    });\n\n    const options: Record<string, string> = {\n      default: defaultOptionLabel as string,\n      everyone: app.translator.trans('huseyinfiliz-private-profile-plus.forum.user.settings.option_everyone') as string,\n      members: app.translator.trans('huseyinfiliz-private-profile-plus.forum.user.settings.option_members') as string,\n      private: app.translator.trans('huseyinfiliz-private-profile-plus.forum.user.settings.option_private') as string,\n    };\n\n    items.add(\n      'profileVisibility',\n      m('.Form-group', [\n        m('label', app.translator.trans('huseyinfiliz-private-profile-plus.forum.user.settings.profile_visibility_heading')),\n        m('.helpText', app.translator.trans('huseyinfiliz-private-profile-plus.forum.user.settings.profile_visibility_help')),\n        m(Select, {\n          options: options,\n          value: currentValue,\n          onchange: (value: string) => {\n            this.user!.savePreferences({ profileVisibility: value });\n          },\n        }),\n      ])\n    );\n  });\n}\n","import { extend } from 'flarum/common/extend';\nimport UserPage from 'flarum/forum/components/UserPage';\nimport app from 'flarum/forum/app';\n\nexport default function addProfileVisibilityHandler() {\n  extend(UserPage.prototype, 'onupdate', function () {\n    const user = this.user;\n\n    if (!user) return;\n\n    const effectiveVisibility = user.attribute('effectiveProfileVisibility');\n    const currentUser = app.session.user;\n    const isOwner = currentUser && currentUser.id() === user.id();\n    const canBypass = app.forum.attribute('canBypassProfileVisibility');\n\n    let canView = true;\n\n    switch (effectiveVisibility) {\n      case 'everyone':\n        canView = true;\n        break;\n      case 'members':\n        canView = !!currentUser;\n        break;\n      case 'private':\n        canView = !!(isOwner || canBypass);\n        break;\n      default:\n        canView = true;\n    }\n\n    if (canView) return;\n\n    // Show appropriate message\n    const placeholderElement = this.element.querySelector('.PostsUserPage .Placeholder, .DiscussionsUserPage .Placeholder');\n\n    if (placeholderElement?.querySelector('p')) {\n      let messageKey: string;\n\n      if (effectiveVisibility === 'members') {\n        messageKey = 'huseyinfiliz-private-profile-plus.forum.profile_members_only';\n      } else {\n        messageKey = 'huseyinfiliz-private-profile-plus.forum.profile_private';\n      }\n\n      placeholderElement.querySelector('p')!.textContent = app.translator.trans(messageKey) as string;\n    }\n  });\n}\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","app","add","extend","SettingsPage","items","_this$user$preference","level","_this","globalDefaultLabel","everyone","members","private","String","attribute","trans","this","user","currentValue","preferences","profileVisibility","options","default","m","Select","value","onchange","savePreferences","UserPage","effectiveVisibility","currentUser","isOwner","id","canBypass","canView","messageKey","placeholderElement","element","querySelector","textContent"],"sourceRoot":""}